<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/svg+xml" href="/vite.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title data-i18n="app-title">ClassSend</title>
  <script type="module" crossorigin src="/assets/index-DtDXECdd.js"></script>
  <link rel="stylesheet" crossorigin href="/assets/index-Dc13BYtz.css">
</head>

<body>
  <div id="app">
    <!-- Role Selection Screen -->
    <div id="role-selection" class="screen">
      <div class="screen-content">
        <h1>ClassSend</h1>
        <h2>Select Your Role</h2>
        <div class="card-container">
          <button id="btn-teacher" class="role-card teacher-card">
            <span class="role-icon">ğŸ‘¨â€ğŸ«</span>
            <span class="role-label">Teacher</span>
          </button>
          <button id="btn-student" class="role-card student-card">
            <span class="role-icon">ğŸ‘¨â€ğŸ“</span>
            <span class="role-label">Student</span>
          </button>
        </div>

      </div>
    </div>

    <!-- Class Setup Screen (Teacher/Student) -->
    <div id="class-setup" class="screen hidden">
      <div class="screen-content">
        <h1>ClassSend</h1>
        <div id="setup-form">
          <h2 id="setup-title">Create Class</h2>
          <div class="input-group">
            <label for="class-id-input">Class ID</label>
            <input type="text" id="class-id-input" placeholder="e.g., MATH101" autocomplete="off">
          </div>
          <div class="input-group">
            <label for="user-name-input">Your Name</label>
            <input type="text" id="user-name-input" placeholder="e.g., John Doe" autocomplete="off">
          </div>
          <button id="btn-submit-setup" class="primary-btn">Create Class</button>
          <button id="btn-back" class="secondary-btn">Back</button>
        </div>
      </div>
    </div>

    <!-- Available Classes Screen (Student Only) -->
    <div id="available-classes" class="screen hidden">
      <div class="screen-content">
        <h1>ClassSend</h1>
        <h2>Available Classes</h2>
        <div id="available-classes-list" class="available-classes-list">
          <!-- Classes will be dynamically added here -->
          <div class="empty-state">Looking for classes...</div>
        </div>
        <button id="btn-back-from-classes" class="secondary-btn">Back</button>
      </div>
    </div>

    <!-- Chat Interface -->
    <div id="chat-interface" class="hidden">
      <!-- Header -->
      <header class="chat-header">
        <div class="header-left">
          <button id="btn-menu-toggle" class="header-btn menu-btn mobile-only">
            â˜°
          </button>
          <div id="connection-status" class="status disconnected" title="Connection Status"
            data-i18n="status-disconnected" data-i18n-title="status-disconnected">Disconnected</div>
          <h1 class="app-title" data-i18n="app-title">ClassSend</h1>
          <div class="user-menu">
            <button id="user-name-btn" class="user-name-display" data-i18n="label-name">Your Name â–¼</button>
            <div id="user-name-dropdown" class="dropdown-menu hidden">
              <input type="text" id="new-name-input" placeholder="Enter new name"
                data-i18n-placeholder="placeholder-name">
              <button id="btn-change-name" class="dropdown-btn" data-i18n="btn-change-name">Change Name</button>
            </div>
          </div>
          <!-- Buttons moved to left -->
          <button id="btn-show-url" class="header-btn" title="Show Server URL">ğŸŒ</button>
          <button id="btn-media-toggle" class="header-btn media-btn" title="Media Library"
            data-i18n-title="btn-media-title">
            ğŸ–¼ï¸ <span data-i18n="btn-media-title" class="desktop-only">Library</span>
          </button>
          <button id="btn-settings-toggle" class="header-btn settings-btn" title="Settings"
            data-i18n-title="btn-settings-title">
            âš™ï¸ <span data-i18n="btn-settings-title" class="desktop-only">Settings</span>
          </button>
        </div>

        <!-- Settings Modal -->
        <div id="settings-modal" class="modal hidden">
          <div class="settings-modal-content">
            <div class="popup-header">
              <h3 data-i18n="modal-settings-title">âš™ï¸ Settings</h3>
              <button id="btn-close-settings" class="close-btn">Ã—</button>
            </div>
            <div class="settings-body">
              <!-- Language Section -->
              <div class="settings-section">
                <h4 class="settings-section-header" data-i18n="settings-section-language">ğŸŒ Language</h4>
                <div class="setting-item">
                  <label for="language-select" data-i18n="label-language">Language</label>
                  <select id="language-select" class="setting-select">
                    <option value="en">English</option>
                    <option value="el">Î•Î»Î»Î·Î½Î¹ÎºÎ¬</option>
                  </select>
                </div>
              </div>

              <!-- Streaming Section -->
              <div class="settings-section">
                <h4 class="settings-section-header" data-i18n="settings-section-streaming">ğŸ“º Streaming</h4>
                <div class="setting-item">
                  <label for="screen-share-quality" data-i18n="label-screen-share-quality">Screen Share Quality</label>
                  <select id="screen-share-quality" class="setting-select">
                    <option value="ethernet" data-i18n="quality-ethernet">Ethernet (Fast)</option>
                    <option value="auto" data-i18n="quality-auto">Auto</option>
                    <option value="wifi" data-i18n="quality-wifi">WiFi (Slow)</option>
                  </select>
                </div>
              </div>

              <!-- Content Filtering Section (Teacher Only) -->
              <div id="settings-filter-section" class="settings-section hidden">
                <h4 class="settings-section-header" data-i18n="settings-section-filter">ğŸ§  Content Filtering</h4>
                <div class="setting-item">
                  <label for="filter-mode-select" data-i18n="label-filter-mode">Filter Mode</label>
                  <select id="filter-mode-select" class="setting-select">
                    <option value="legacy" data-i18n="filter-mode-legacy">Legacy (Low RAM)</option>
                    <option value="advanced" data-i18n="filter-mode-advanced">Advanced (Naive Bayes)</option>
                    <option value="deep-learning" data-i18n="filter-mode-deep-learning">Deep Learning (Modern HW)
                    </option>
                  </select>
                </div>
                <p class="setting-hint" data-i18n="filter-mode-hint">Legacy: Client-side word matching. Advanced: Server
                  AI. Deep Learning: Transformer model (requires 2GB+ RAM).</p>
              </div>

              <!-- Data and Privacy Section -->
              <div class="settings-section">
                <h4 class="settings-section-header" data-i18n="settings-section-data">ğŸ”’ Data and Privacy</h4>
                <div class="setting-item">
                  <label data-i18n="label-blacklist-data">Blacklist Data</label>
                  <div class="logs-actions">
                    <button id="btn-import-blacklist" class="secondary-btn" data-i18n="btn-import-blacklist">ğŸ“¥
                      Import</button>
                    <button id="btn-export-blacklist" class="secondary-btn" data-i18n="btn-export-blacklist">ğŸ“¤
                      Export</button>
                    <input type="file" id="file-import-blacklist" accept=".json" class="hidden">
                  </div>
                </div>
                <div class="setting-item">
                  <label data-i18n="label-clear-data">Clear Saved Data</label>
                  <button id="btn-clear-data" class="secondary-btn" data-i18n="btn-clear-data">ğŸ—‘ï¸ Clear</button>
                </div>
              </div>

              <!-- Advanced Section (Teacher Only) -->
              <div id="settings-advanced-section" class="settings-section hidden">
                <h4 class="settings-section-header" data-i18n="settings-section-advanced">ğŸ”§ Advanced</h4>
                <div class="setting-item logs-setting">
                  <label data-i18n="label-logs">Session Logs</label>
                  <div class="logs-actions">
                    <button id="btn-view-logs" class="secondary-btn" data-i18n="btn-view-logs">ğŸ‘ï¸ View</button>
                    <button id="btn-download-logs" class="secondary-btn" data-i18n="btn-download-logs">â¬‡ï¸
                      Download</button>
                  </div>
                </div>
                <div id="logs-viewer" class="logs-viewer hidden">
                  <div class="logs-viewer-header">
                    <span data-i18n="logs-title">Session Logs</span>
                    <button id="btn-copy-logs" class="copy-btn" title="Copy Logs">ğŸ“‹</button>
                    <button id="btn-close-logs" class="close-btn">Ã—</button>
                  </div>
                  <pre id="logs-content" class="logs-content"></pre>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Video Stream Modal -->
        <div id="video-modal" class="modal hidden">
          <div class="modal-content video-modal-content">
            <div class="popup-header">
              <h3 id="stream-title">ğŸ“º Teacher's Screen</h3>
              <div class="video-header-controls">
                <button id="btn-minimize-video" class="header-control-btn" title="Minimize">â–</button>
                <button id="btn-close-video" class="close-btn" title="Close">Ã—</button>
              </div>
            </div>
            <div class="video-container">
              <video id="remote-video" autoplay playsinline></video>
              <div id="video-status" class="video-status">Connecting...</div>
              <!-- Video Controls -->
              <div class="video-controls">
                <button id="btn-zoom-out" class="video-control-btn" title="Zoom Out">â–</button>
                <button id="btn-zoom-reset" class="video-control-btn" title="Reset Zoom">100%</button>
                <button id="btn-zoom-in" class="video-control-btn" title="Zoom In">â•</button>
                <button id="btn-fullscreen" class="video-control-btn" title="Fullscreen">â›¶</button>
              </div>
            </div>
          </div>
        </div>
        <!-- header-right removed -->
      </header>

      <!-- Media Modal -->
      <div id="media-popup" class="media-modal hidden">
        <div class="modal-content">
          <div class="popup-header">
            <h3>Media Library</h3>
            <button id="btn-download-all" class="download-all-btn" title="Download All Files">â¬‡ï¸ Download All</button>
            <button id="btn-close-media" class="close-btn">Ã—</button>
          </div>
          <div id="media-list" class="media-list">
            <div class="empty-media-state">No media shared yet</div>
          </div>
        </div>
      </div>

      <!-- Connection Info Modal -->
      <div id="connection-modal" class="modal hidden">
        <div class="modal-content connection-modal-content">
          <div class="popup-header">
            <h3>Connection Info</h3>
            <button id="btn-close-connection" class="close-btn">Ã—</button>
          </div>
          <div class="connection-body">
            <p>Students can connect at:</p>
            <div class="url-display-container">
              <code id="connection-url">http://...</code>
              <button id="btn-copy-url" class="copy-btn" title="Copy URL">ğŸ“‹</button>
            </div>

            <div class="toggle-container">
              <span class="toggle-label">Standard IP</span>
              <label class="switch">
                <input type="checkbox" id="hostname-toggle">
                <span class="slider round"></span>
              </label>
              <span class="toggle-label">Short Name</span>
            </div>
            <p class="toggle-hint">Use "Short Name" for easier typing.</p>
          </div>
        </div>
      </div>

      <!-- Blacklist Modal (Teacher Only) -->
      <div id="dictionary-modal" class="modal hidden">
        <div class="modal-content dictionary-modal-content">
          <div class="popup-header">
            <h3>ğŸš« Blacklist</h3>
            <button id="btn-close-dictionary" class="close-btn">Ã—</button>
          </div>
          <div class="dictionary-body">
            <div class="dictionary-add-section">
              <input type="text" id="dictionary-word-input" placeholder="Enter word to add..." autocomplete="off"
                data-i18n-placeholder="placeholder-blacklist">
              <button id="btn-add-word" class="add-word-btn" data-i18n="btn-add">Add â•</button>
            </div>
            <div id="dictionary-word-list" class="dictionary-word-list">
              <!-- Words will be dynamically added here -->
              <div class="empty-dictionary-state">No custom words added yet</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Text Selection Popup (for adding words from chat) -->
      <div id="text-selection-popup" class="text-selection-popup hidden">
        <button id="btn-add-selection-to-dictionary" data-i18n="text-selection-popup-add">Add to forbidden words
          â•</button>
      </div>

      <!-- AI Loading Modal -->
      <div id="ai-loading-modal" class="modal hidden">
        <div class="ai-loading-content">
          <div class="ai-loading-spinner">ğŸ§ </div>
          <h3 data-i18n="ai-loading-title">Loading AI Model...</h3>
          <p id="ai-loading-status" data-i18n="ai-loading-downloading">Downloading model (0%)</p>
          <div class="ai-loading-bar">
            <div id="ai-loading-progress" class="ai-loading-progress"></div>
          </div>
          <p class="ai-loading-hint" data-i18n="ai-loading-hint">First load requires ~300MB download. Subsequent loads
            are instant.</p>
        </div>
      </div>


      <!-- File Progress Modal -->
      <!-- File Progress Modal (Removed) -->


      <!-- Main Content -->
      <div class="chat-main">
        <!-- Mobile Sidebar Overlay -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- Left Sidebar - Classes & Users -->
        <aside id="sidebar-left" class="sidebar-left">
          <!-- Teacher Actions (Blacklist & Screen Share) -->
          <div id="teacher-actions" class="sidebar-actions hidden">
            <button id="btn-dictionary" class="action-btn" title="Manage Forbidden Words"
              data-i18n-title="btn-dictionary">
              <span data-i18n="btn-dictionary">ğŸš« Blacklist</span>
            </button>
            <button id="btn-share-screen" class="action-btn" title="Share Screen" data-i18n-title="btn-share-screen">
              <span data-i18n="btn-share-screen">ğŸ“º Share</span>
            </button>
          </div>

          <div class="sidebar-header">
            <h3 data-i18n="header-classes">Classes</h3>
          </div>
          <div class="classes-list">
            <!-- Classes will be dynamically added here -->
          </div>

          <div class="sidebar-header" id="users-header-container">
            <h3 data-i18n="header-users">Users</h3>
            <span id="user-count" class="user-count">0</span>
            <button id="btn-hands-down" class="btn-hands-down hidden" title="Lower All Hands">ğŸ–ï¸ Hands Down</button>
          </div>
          <div id="users-list" class="users-list">
            <!-- Users will be dynamically added here -->
          </div>
        </aside>

        <!-- Center - Messages -->
        <main class="chat-area">
          <div id="messages-container" class="messages-container">
            <!-- Messages will be dynamically added here -->
          </div>
          <div class="message-input-area">
            <div id="filter-warning" class="filter-warning hidden">
              âš ï¸ Inappropriate content detected
            </div>
            <div class="input-actions-left">
              <button id="btn-attach-file" class="attach-btn" title="Attach file">
                ğŸ“
              </button>
              <button id="btn-emoji" class="emoji-btn" title="Insert Emoji">
                ğŸ˜€
              </button>
              <button id="btn-raise-hand" class="raise-hand-btn" title="Raise Hand">
                ğŸ–ï¸
              </button>
              <button id="btn-view-stream" class="view-stream-btn hidden" title="View Stream">
                ğŸ“º
              </button>
              <button id="btn-report-toggle" class="report-toggle-btn hidden" title="Word Reports"
                data-i18n-title="btn-reports-title">
                âš ï¸ <span class="report-badge hidden">0</span>
              </button>
              <div id="emoji-picker" class="emoji-picker hidden">
                <!-- Emojis will be injected here -->
              </div>
              <!-- Report Panel (Teacher Only, like emoji picker) -->
              <div id="report-panel" class="report-panel hidden">
                <div class="report-panel-header">
                  <span data-i18n="modal-reports-title">âš ï¸ Reported Words</span>
                </div>
                <!-- Training Notification -->
                <div id="training-notification" class="training-notification hidden">
                  <div class="training-content">
                    <span class="spinner">â†»</span>
                    <span>Consolidating AI Model...</span>
                  </div>
                </div>
                <div id="report-list" class="report-list">
                  <div class="empty-report-state" data-i18n="reports-empty">No pending reports</div>
                </div>
              </div>
            </div>
            <input type="file" id="file-input" class="hidden">
            <input type="text" id="message-input" placeholder="Type a message..." autocomplete="off">
            <button id="btn-send-message" class="send-btn">
              Send
            </button>
          </div>
        </main>
      </div>
    </div>
  </div>
</body>

</html>